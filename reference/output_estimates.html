<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Policy evaluation with adaptively generated data. — output_estimates • banditsCI</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Policy evaluation with adaptively generated data. — output_estimates"><meta name="description" content="Calculates average response and differences in average response under counterfactual treatment policies.
Estimates are produced using provided inverse probability weighted (IPW) or augmented inverse probability weighted (AIPW) scores paired with various adaptive weighting schemes, as proposed in hadad2021confidence;textualbanditsCI and zhan2021off;textualbanditsCI.


We briefly outline the target quantities:
For observations indexed \(t \in \{1,\dots,A\}\), treatments \(w \in \{1,\dots,K\}\), we denote as \(Y_t(w)\) the potential outcome for the unit at time \(t\) under treatment \(w\).
A policy \(\pi\) is a treatment assignment procedure that is the subject of evaluation, described in terms of treatment assignment probabilities for each subject to receive each counterfactual treatment.
We target estimation of average response under a specified policy:
$$Q(\pi) := \sum_{w = 1}^{K}\textrm{E}\left[\pi(w)Y_t(w)\right]$$
The user may specify a list of list of policies to be evaluated, under policy1.


Alternatively, they may estimate policy contrasts if policy0 is provided:
$$\Delta(\pi^1,\pi^2) := Q(\pi^1) - Q(\pi^2) $$"><meta property="og:description" content="Calculates average response and differences in average response under counterfactual treatment policies.
Estimates are produced using provided inverse probability weighted (IPW) or augmented inverse probability weighted (AIPW) scores paired with various adaptive weighting schemes, as proposed in hadad2021confidence;textualbanditsCI and zhan2021off;textualbanditsCI.


We briefly outline the target quantities:
For observations indexed \(t \in \{1,\dots,A\}\), treatments \(w \in \{1,\dots,K\}\), we denote as \(Y_t(w)\) the potential outcome for the unit at time \(t\) under treatment \(w\).
A policy \(\pi\) is a treatment assignment procedure that is the subject of evaluation, described in terms of treatment assignment probabilities for each subject to receive each counterfactual treatment.
We target estimation of average response under a specified policy:
$$Q(\pi) := \sum_{w = 1}^{K}\textrm{E}\left[\pi(w)Y_t(w)\right]$$
The user may specify a list of list of policies to be evaluated, under policy1.


Alternatively, they may estimate policy contrasts if policy0 is provided:
$$\Delta(\pi^1,\pi^2) := Q(\pi^1) - Q(\pi^2) $$"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">banditsCI</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/banditsCI.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/UChicago-pol-methods/banditsCI/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Policy evaluation with adaptively generated data.</h1>
      <small class="dont-index">Source: <a href="https://github.com/UChicago-pol-methods/banditsCI/blob/main/R/adaptive_utils.R" class="external-link"><code>R/adaptive_utils.R</code></a></small>
      <div class="d-none name"><code>output_estimates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates average response and differences in average response under counterfactual treatment policies.
Estimates are produced using provided inverse probability weighted (IPW) or augmented inverse probability weighted (AIPW) scores paired with various adaptive weighting schemes, as proposed in hadad2021confidence;textualbanditsCI and zhan2021off;textualbanditsCI.
<br><br>
We briefly outline the target quantities:
For observations indexed \(t \in \{1,\dots,A\}\), treatments \(w \in \{1,\dots,K\}\), we denote as \(Y_t(w)\) the potential outcome for the unit at time \(t\) under treatment \(w\).
A policy \(\pi\) is a treatment assignment procedure that is the subject of evaluation, described in terms of treatment assignment probabilities for each subject to receive each counterfactual treatment.
We target estimation of average response under a specified policy:
$$Q(\pi) := \sum_{w = 1}^{K}\textrm{E}\left[\pi(w)Y_t(w)\right]$$
The user may specify a list of list of policies to be evaluated, under <code>policy1</code>.
<br><br>
Alternatively, they may estimate policy contrasts if <code>policy0</code> is provided:
$$\Delta(\pi^1,\pi^2) := Q(\pi^1) - Q(\pi^2) $$</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">output_estimates</span><span class="op">(</span></span>
<span>  policy0 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">policy1</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="st">"combined"</span>,</span>
<span>  <span class="va">gammahat</span>,</span>
<span>  <span class="va">probs_array</span>,</span>
<span>  uniform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  non_contextual_minvar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contextual_minvar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  non_contextual_stablevar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contextual_stablevar <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  non_contextual_twopoint <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  floor_decay <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-policy-">policy0<a class="anchor" aria-label="anchor" href="#arg-policy-"></a></dt>
<dd><p>Optional matrix. Single policy probability matrix for contrast evaluation, dimensions <code>[A, K]</code>. Each row represents treatment assignment probabilities for an individual subject, and so rows must sum to 1. When <code>policy0 = NULL</code>, the function estimates the value \(Q(\pi)\) of each policy matrix listed in <code>policy1</code>. When <code>policy0</code> is non-null, the function estimates differences in average response under each of the component policies in <code>policy1</code> and the <em>single</em> policy in <code>policy0</code>. Must not contain NA values if provided.</p></dd>


<dt id="arg-policy-">policy1<a class="anchor" aria-label="anchor" href="#arg-policy-"></a></dt>
<dd><p>List of matrices. List of counterfactual policy matrices for evaluation, dimensions <code>[A, K]</code>. Each row represents treatment assignment probabilities for an individual subject, and so rows must sum to 1. Must not contain NA values.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>Character. The method to estimate policy contrasts, either <code>combined</code> or <code>separate</code>, discussed in hadad2021confidence;textualbanditsCI Section 3. <code>combined</code> indicates the difference in (A)IPW scores is directly used as the unbiased scoring rule for \(\Delta (\pi^1, \pi^2)\); <code>separate</code> indicates that scores are used separately \(\hat \Delta (\pi^1, \pi^2) = \hat Q (w_1) - \hat Q (w_2)\).</p></dd>


<dt id="arg-gammahat">gammahat<a class="anchor" aria-label="anchor" href="#arg-gammahat"></a></dt>
<dd><p>(A)IPW scores matrix with dimensions <code>[A, K]</code> in non-contextual settings, or <code>[A, A, K]</code> contextual settings. Dimensions represent time, (contexts,) treatment arms. Dimensions of <code>gammahat</code> and <code>probs_array</code> must be the same. Must not contain NA values.</p></dd>


<dt id="arg-probs-array">probs_array<a class="anchor" aria-label="anchor" href="#arg-probs-array"></a></dt>
<dd><p>Numeric array. Probability matrix or array with dimensions <code>[A, K]</code> in non-contextual settings, or <code>[A, A, K]</code> contextual settings. Dimensions represent time, (contexts,) treatment arms. Dimensions of <code>gammahat</code> and <code>probs_array</code> must be the same. Must not contain NA values.</p></dd>


<dt id="arg-uniform">uniform<a class="anchor" aria-label="anchor" href="#arg-uniform"></a></dt>
<dd><p>Logical. Estimate uniform weights.</p></dd>


<dt id="arg-non-contextual-minvar">non_contextual_minvar<a class="anchor" aria-label="anchor" href="#arg-non-contextual-minvar"></a></dt>
<dd><p>Logical. Estimate non-contextual <code>MinVar</code> weights described in zhan2021off;textualbanditsCI Section 4.</p></dd>


<dt id="arg-contextual-minvar">contextual_minvar<a class="anchor" aria-label="anchor" href="#arg-contextual-minvar"></a></dt>
<dd><p>Logical. Estimate contextual <code>MinVar</code> weights described in zhan2021off;textualbanditsCI Section 4.</p></dd>


<dt id="arg-non-contextual-stablevar">non_contextual_stablevar<a class="anchor" aria-label="anchor" href="#arg-non-contextual-stablevar"></a></dt>
<dd><p>Logical. Estimate non-contextual <code>StableVar</code> weights described in zhan2021off;textualbanditsCI Section 4.</p></dd>


<dt id="arg-contextual-stablevar">contextual_stablevar<a class="anchor" aria-label="anchor" href="#arg-contextual-stablevar"></a></dt>
<dd><p>Logical. Estimate contextual <code>StableVar</code> weights  described in zhan2021off;textualbanditsCI Section 4.</p></dd>


<dt id="arg-non-contextual-twopoint">non_contextual_twopoint<a class="anchor" aria-label="anchor" href="#arg-non-contextual-twopoint"></a></dt>
<dd><p>Logical. Estimate <code>two-point</code> allocation weights described in hadad2021confidence;textualbanditsCI Section 2.</p></dd>


<dt id="arg-floor-decay">floor_decay<a class="anchor" aria-label="anchor" href="#arg-floor-decay"></a></dt>
<dd><p>Numeric. Floor decay parameter used in the calculation. Default is 0.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of treatment effect estimates under different weighting schemes.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>hadad2021confidencebanditsCI</p>
<p>zhan2021offbanditsCI</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># In a non-contextual setting, generate example values for policy1, gammahat, and probs_array</span></span></span>
<span class="r-in"><span><span class="va">gammahat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.8</span>, <span class="fl">0.6</span>,</span></span>
<span class="r-in"><span>                     <span class="fl">0.3</span>, <span class="fl">0.9</span>, <span class="fl">0.2</span>,</span></span>
<span class="r-in"><span>                     <span class="fl">0.5</span>, <span class="fl">0.7</span>, <span class="fl">0.4</span>,</span></span>
<span class="r-in"><span>                     <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.6</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">policy0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                    <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                    <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                    <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">policy1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,</span></span>
<span class="r-in"><span>                         <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">probs_array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fl">0</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">temp_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">normalized_vector</span> <span class="op">&lt;-</span> <span class="va">temp_vector</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">temp_vector</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">probs_array</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">normalized_vector</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">temp_vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">normalized_vector</span> <span class="op">&lt;-</span> <span class="va">temp_vector</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">temp_vector</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="va">probs_array</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>, <span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">normalized_vector</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu">output_estimates</span><span class="op">(</span>policy1 <span class="op">=</span> <span class="va">policy1</span>,</span></span>
<span class="r-in"><span>                              policy0 <span class="op">=</span> <span class="va">policy0</span>,</span></span>
<span class="r-in"><span>                              gammahat <span class="op">=</span> <span class="va">gammahat</span>,</span></span>
<span class="r-in"><span>                              probs_array <span class="op">=</span> <span class="va">probs_array</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot</span></span></span>
<span class="r-in"><span><span class="va">plot_results</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">[</span>, <span class="st">"estimate"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">std.errors</span> <span class="op">&lt;-</span> <span class="va">result</span><span class="op">[</span>, <span class="st">"std.error"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Define the limits for the x-axis based on estimates and std.errors</span></span></span>
<span class="r-in"><span>  <span class="va">xlims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">-</span> <span class="va">std.errors</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">+</span> <span class="va">std.errors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Create the basic error bar plot using base R</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">estimates</span>, <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="va">xlims</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>,</span></span>
<span class="r-in"><span>         xlab <span class="op">=</span> <span class="st">"Coefficient Estimate"</span>, ylab <span class="op">=</span> <span class="st">""</span>,</span></span>
<span class="r-in"><span>         yaxt <span class="op">=</span> <span class="st">"n"</span>, pch <span class="op">=</span> <span class="fl">16</span>, las <span class="op">=</span> <span class="fl">1</span>, main <span class="op">=</span> <span class="st">"Coefficients and CIs"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Add y-axis labels</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span>, labels <span class="op">=</span> <span class="va">labels</span>, las <span class="op">=</span> <span class="fl">1</span>, tick <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>         line <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Add the x-axis values</span></span></span>
<span class="r-in"><span>  <span class="va">x_ticks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">xlims</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, to <span class="op">=</span> <span class="va">xlims</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>         at <span class="op">=</span> <span class="va">x_ticks</span><span class="op">[</span></span></span>
<span class="r-in"><span>           <span class="op">(</span><span class="va">x_ticks</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">+</span> <span class="va">std.errors</span><span class="op">)</span> <span class="op">|</span></span></span>
<span class="r-in"><span>              <span class="va">x_ticks</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">-</span> <span class="va">std.errors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="op">]</span>,</span></span>
<span class="r-in"><span>         labels <span class="op">=</span> <span class="va">x_ticks</span><span class="op">[</span></span></span>
<span class="r-in"><span>           <span class="op">(</span><span class="va">x_ticks</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">+</span> <span class="va">std.errors</span><span class="op">)</span> <span class="op">|</span></span></span>
<span class="r-in"><span>              <span class="va">x_ticks</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">-</span> <span class="va">std.errors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>         <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Add error bars</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/segments.html" class="external-link">segments</a></span><span class="op">(</span><span class="va">estimates</span> <span class="op">-</span> <span class="va">std.errors</span>,</span></span>
<span class="r-in"><span>             <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             <span class="va">estimates</span> <span class="op">+</span> <span class="va">std.errors</span>,</span></span>
<span class="r-in"><span>             <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sample_result</span> <span class="op">&lt;-</span> <span class="va">estimates</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">12</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_results</span><span class="op">(</span><span class="va">sample_result</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="output_estimates-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Molly Offer-Westort, Yinghui Zhou.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

